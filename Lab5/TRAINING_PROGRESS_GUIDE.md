# YOLOv3 è¨“ç·´é€²åº¦é¡¯ç¤ºæŒ‡å—

## ğŸ“Š è¨“ç·´é€²åº¦åŠŸèƒ½

å·²ç‚º `train.py` æ·»åŠ äº†è©³ç´°çš„è¨“ç·´é€²åº¦é¡¯ç¤ºåŠŸèƒ½ï¼Œä½¿ç”¨ `tqdm` é€²åº¦æ¢å¯¦æ™‚ç›£æ§è¨“ç·´ç‹€æ…‹ã€‚

---

## ğŸš€ å•Ÿå‹•è¨“ç·´

```bash
cd c:\Users\Danny\Desktop\clone\Lab5\Lab5
python train.py
```

---

## ğŸ“º é€²åº¦é¡¯ç¤ºç¤ºä¾‹

### 1. **åˆå§‹åŒ–éšæ®µ**
```
============================================================
YOLOv3 Object Detection Training
============================================================
Using device: cuda

Hyperparameters:
  Epochs: 50
  Batch size: 16
  Learning rate: 0.001
  Lambda coord: 5.0
  Lambda obj: 1.0
  Lambda noobj: 0.5
  Lambda class: 1.0

============================================================
Loading datasets...
============================================================
Loaded 8218 train images
Loaded 3823 val images

============================================================
Initializing model...
============================================================
```

### 2. **è¨“ç·´é€²åº¦æ¢**

æ¯å€‹ epoch æœƒé¡¯ç¤ºè©³ç´°çš„è¨“ç·´é€²åº¦ï¼š

```
============================================================
Epoch [1/50]
============================================================
Training: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 514/514 [02:15<00:00, 3.78it/s, loss=12.3456, box=4.123, obj=5.678, cls=2.544]

ğŸ“Š Training Summary:
  Total Loss:  12.3456
  Box Loss:    4.1230
  Obj Loss:    5.6780
  Class Loss:  2.5446
  Learning Rate: 0.001000
```

**é€²åº¦æ¢èªªæ˜ï¼š**
- `100%`: å®Œæˆç™¾åˆ†æ¯”
- `514/514`: ç•¶å‰batch/ç¸½batchæ•¸
- `[02:15<00:00]`: å·²ç”¨æ™‚é–“<å‰©é¤˜æ™‚é–“
- `3.78it/s`: æ¯ç§’è™•ç†çš„batchæ•¸ï¼ˆé€Ÿåº¦ï¼‰
- `loss=12.3456`: ç•¶å‰batchçš„ç¸½æå¤±
- `box=4.123`: é‚Šç•Œæ¡†æå¤±
- `obj=5.678`: ç‰©é«”ç½®ä¿¡åº¦æå¤±
- `cls=2.544`: åˆ†é¡æå¤±

### 3. **é©—è­‰é€²åº¦æ¢**

```
ğŸ” Validating...
Validation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 239/239 [00:45<00:00, 5.31it/s, loss=10.2345]

ğŸ“Š Validation Summary:
  Total Loss:  10.2345
  Box Loss:    3.8920
  Obj Loss:    4.5670
  Class Loss:  1.7755
```

### 4. **æª¢æŸ¥é»ä¿å­˜**

```
âœ“ New best val loss: 10.23450
âœ“ Saved checkpoint: checkpoints/detector_epoch_5.pth
```

### 5. **mAP è©•ä¼°ï¼ˆæ¯5å€‹epochï¼‰**

```
------------------------------------------------------------
ğŸ“ˆ Evaluating mAP on validation set...
------------------------------------------------------------
ğŸ¯ Epoch 5 - mAP: 0.4521
------------------------------------------------------------

============================================================
âœ… Epoch 5/50 Completed
============================================================
```

### 6. **è¨“ç·´å®Œæˆ**

```
============================================================
ğŸ‰ Training completed!
ğŸ† Best validation loss: 8.95432
ğŸ’¾ Best model saved at: checkpoints/best_detector.pth
============================================================
```

---

## ğŸ“ˆ å¯¦æ™‚ç›£æ§æŒ‡æ¨™

### è¨“ç·´éšæ®µæ¯å€‹batché¡¯ç¤ºï¼š
- âœ… **Total Loss**: ç¸½æå¤±ï¼ˆç”¨æ–¼backwardï¼‰
- âœ… **Box Loss**: é‚Šç•Œæ¡†å›æ­¸æå¤±ï¼ˆGIoU + å¯¬é«˜ï¼‰
- âœ… **Obj Loss**: ç‰©é«”ç½®ä¿¡åº¦æå¤±
- âœ… **Class Loss**: åˆ†é¡æå¤±

### æ¯å€‹epochçµæŸé¡¯ç¤ºï¼š
- âœ… **å¹³å‡è¨“ç·´æå¤±**ï¼ˆç¸½æå¤± + å„åˆ†é …ï¼‰
- âœ… **ç•¶å‰å­¸ç¿’ç‡**
- âœ… **å¹³å‡é©—è­‰æå¤±**ï¼ˆç¸½æå¤± + å„åˆ†é …ï¼‰
- âœ… **æ˜¯å¦ç‚ºæœ€ä½³æ¨¡å‹**

### æ¯5å€‹epoché¡¯ç¤ºï¼š
- âœ… **mAPåˆ†æ•¸**ï¼ˆé©—è­‰é›†ï¼‰
- âœ… **ä¿å­˜é€±æœŸæ€§æª¢æŸ¥é»**

---

## ğŸ¯ å¦‚ä½•è§£è®€é€²åº¦

### æ­£å¸¸è¨“ç·´è·¡è±¡ï¼š
1. âœ… **æå¤±ä¸‹é™**ï¼šå„é …æå¤±éš¨epoché€æ¼¸æ¸›å°
2. âœ… **é€Ÿåº¦ç©©å®š**ï¼šit/sï¼ˆè¿­ä»£/ç§’ï¼‰ä¿æŒç©©å®š
3. âœ… **é©—è­‰æå¤±æ¥è¿‘è¨“ç·´æå¤±**ï¼šæ¨¡å‹æ³›åŒ–è‰¯å¥½
4. âœ… **mAPé€æ¼¸æå‡**ï¼šæ¨¡å‹æ€§èƒ½æå‡

### ç•°å¸¸æƒ…æ³è­¦ç¤ºï¼š
1. âš ï¸ **æå¤±ä¸ä¸‹é™æˆ–ä¸Šå‡**ï¼šå¯èƒ½å­¸ç¿’ç‡éå¤§
2. âš ï¸ **æå¤±ç‚ºNaN/Inf**ï¼šæ•¸å€¼ä¸ç©©å®šï¼Œéœ€æª¢æŸ¥è¼¸å…¥
3. âš ï¸ **é€Ÿåº¦çªç„¶è®Šæ…¢**ï¼šå¯èƒ½è¨˜æ†¶é«”ä¸è¶³
4. âš ï¸ **é©—è­‰æå¤±é é«˜æ–¼è¨“ç·´æå¤±**ï¼šéæ“¬åˆ

---

## ğŸ’¡ é€²åº¦æ¢åŠŸèƒ½

### tqdm é€²åº¦æ¢å„ªå‹¢ï¼š
- âœ… **å¯¦æ™‚æ›´æ–°**ï¼šæ¯å€‹batchå³æ™‚æ›´æ–°
- âœ… **æ™‚é–“ä¼°è¨ˆ**ï¼šé ä¼°å‰©é¤˜è¨“ç·´æ™‚é–“
- âœ… **é€Ÿåº¦ç›£æ§**ï¼šé¡¯ç¤ºè™•ç†é€Ÿåº¦ï¼ˆit/sï¼‰
- âœ… **å‹•æ…‹ä¿¡æ¯**ï¼šé¡¯ç¤ºç•¶å‰æå¤±å€¼
- âœ… **è¦–è¦ºåŒ–**ï¼šç›´è§€çš„é€²åº¦æ¢é¡¯ç¤º

### è‡ªå®šç¾©é…ç½®ï¼š
```python
pbar = tqdm(train_loader, desc=f'Training', 
           bar_format='{l_bar}{bar:30}{r_bar}{bar:-30b}')
```
- `desc`: é€²åº¦æ¢æè¿°
- `bar_format`: è‡ªå®šç¾©é¡¯ç¤ºæ ¼å¼
- `{l_bar}`: å·¦å´æ¨™ç±¤
- `{bar:30}`: é€²åº¦æ¢ï¼ˆ30å­—ç¬¦å¯¬ï¼‰
- `{r_bar}`: å³å´è³‡è¨Š

---

## ğŸ“Š å®Œæ•´è¨“ç·´è¼¸å‡ºç¤ºä¾‹

```
============================================================
Epoch [10/50]
============================================================
Training: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 514/514 [02:18<00:00, 3.71it/s, loss=8.2341, box=3.012, obj=3.456, cls=1.766]

ğŸ“Š Training Summary:
  Total Loss:  8.2341
  Box Loss:    3.0120
  Obj Loss:    3.4560
  Class Loss:  1.7661
  Learning Rate: 0.000824

ğŸ” Validating...
Validation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 239/239 [00:47<00:00, 5.04it/s, loss=7.8923]

ğŸ“Š Validation Summary:
  Total Loss:  7.8923
  Box Loss:    2.9010
  Obj Loss:    3.2340
  Class Loss:  1.7573

âœ“ New best val loss: 7.89230
âœ“ Saved checkpoint: checkpoints/detector_epoch_10.pth

------------------------------------------------------------
ğŸ“ˆ Evaluating mAP on validation set...
------------------------------------------------------------
ğŸ¯ Epoch 10 - mAP: 0.5234
------------------------------------------------------------

============================================================
âœ… Epoch 10/50 Completed
============================================================
```

---

## ğŸ”§ å¦‚æœéœ€è¦æ›´æ”¹

### èª¿æ•´é€²åº¦é¡¯ç¤ºé »ç‡ï¼š

**ç•¶å‰è¨­å®š**ï¼š
- è¨“ç·´ï¼šæ¯å€‹batchæ›´æ–°é€²åº¦æ¢
- é©—è­‰ï¼šæ¯å€‹batchæ›´æ–°é€²åº¦æ¢
- mAPï¼šæ¯5å€‹epochè©•ä¼°

**ä¿®æ”¹æ–¹æ³•**ï¼š
åœ¨ `train.py` ä¸­ä¿®æ”¹ï¼š
```python
# ä¿®æ”¹ mAP è©•ä¼°é »ç‡ï¼ˆç•¶å‰ç‚º5ï¼‰
if (epoch + 1) % 10 == 0:  # æ”¹ç‚ºæ¯10å€‹epoch
    val_aps = evaluate(model, eval_loader)
```

### èª¿æ•´é€²åº¦æ¢å¯¬åº¦ï¼š
```python
# ä¿®æ”¹ bar:30 ç‚ºå…¶ä»–æ•¸å­—
bar_format='{l_bar}{bar:50}{r_bar}{bar:-50b}'  # æ›´å¯¬çš„é€²åº¦æ¢
```

---

## ğŸ“ æ—¥èªŒè¨˜éŒ„

å¦‚æœéœ€è¦ä¿å­˜è¨“ç·´æ—¥èªŒåˆ°æ–‡ä»¶ï¼š

```bash
# é‡å®šå‘è¼¸å‡ºåˆ°æ—¥èªŒæ–‡ä»¶
python train.py 2>&1 | tee training.log
```

é€™æ¨£å¯ä»¥åŒæ™‚ï¼š
- âœ… åœ¨çµ‚ç«¯çœ‹åˆ°å¯¦æ™‚é€²åº¦
- âœ… ä¿å­˜å®Œæ•´æ—¥èªŒåˆ° `training.log`

---

## ğŸ“ ç¸½çµ

ç¾åœ¨çš„è¨“ç·´è…³æœ¬æä¾›ï¼š
1. âœ… **è¦–è¦ºåŒ–é€²åº¦æ¢**ï¼šå¯¦æ™‚é¡¯ç¤ºè¨“ç·´/é©—è­‰é€²åº¦
2. âœ… **è©³ç´°æå¤±ä¿¡æ¯**ï¼šç¸½æå¤± + å„åˆ†é …æå¤±
3. âœ… **æ€§èƒ½ç›£æ§**ï¼šè™•ç†é€Ÿåº¦ã€æ™‚é–“ä¼°è¨ˆ
4. âœ… **æª¢æŸ¥é»ç®¡ç†**ï¼šè‡ªå‹•ä¿å­˜æœ€ä½³æ¨¡å‹å’Œé€±æœŸæ€§æª¢æŸ¥é»
5. âœ… **mAPè©•ä¼°**ï¼šå®šæœŸè©•ä¼°æ¨¡å‹æ€§èƒ½
6. âœ… **Emojiæ¨™è¨˜**ï¼šç›´è§€çš„è¦–è¦ºæç¤º

é–‹å§‹è¨“ç·´å¾Œï¼Œæ‚¨å°‡çœ‹åˆ°å®Œæ•´ã€æ¸…æ™°ã€ç¾è§€çš„è¨“ç·´é€²åº¦é¡¯ç¤ºï¼ğŸš€
